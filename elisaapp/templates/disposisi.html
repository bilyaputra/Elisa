{% extends 'base.html' %}
{% load static %}

{% block content %}

  <!-- partial:index.partial.html -->
  <div id="viewport">
    <!-- Sidebar -->
    <div id="sidebar">
      <header>
        <a href="#">Elisa</a>
      </header>
      <ul class="nav flex-column">
        <li class="nav-item">
          <a class="nav-link" href="{% url 'dashAdmin' %}">
            <i class="fas fa-th-large"></i> Dashboard
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'disposisi' %}">
          <i class="fas fa-paper-plane"></i> Disposisi
          </a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="{% url 'logout' %}">
            <i class="fas fa-sign-out-alt"></i> Log Out
          </a>
        </li>
      </ul>
    </div>

    <!-- navbar -->
    <nav class="navbar navbar-expand navbar-light bg-white topbar static-top shadow">
        <ul class="navbar-nav ms-auto">
          <li id="dropdown" class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDarkDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              <img class="rounded-circle"
                    src="{% static 'images/undraw_profile.svg' %}"
                    height="30"
                    alt=""
                    loading="lazy">
              {{ user }}
            </a>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDarkDropdownMenuLink">
              <li><a class="dropdown-item" href="#"><i class="fas fa-user"></i> Account</a></li>
              <div class="dropdown-divider"></div>
              <li><a class="dropdown-item" href="{% url 'logout' %}"><i class="fas fa-sign-out-alt"></i> Log Out</a></li>
            </ul>
          </li>
        </ul>
    </nav>

    <!-- Content -->

    <div id="input-surat">
      <div class="card">
        <h2 class="card-header">Disposisi</h2>
        <div class="card-body">

          {% if pesan %}
            <div class="alert alert-success">{{pesan}}</div>
          {% endif %}
          
                <table class="table table-bordered table-striped text-center">
                        <thead>
                            <tr>
                                <th scope="col">No.</th>
                                <th scope="col">Nomor Surat</th>
                                <th scope="col">Perihal</th>
                                {% if grup.name == "wr" %}
                                <th scope="col">Catatan1</th>
                                <th scope="col">Disposisi1</th>
                                {% elif grup.name == "dekan" %}
                                <th scope="col">Catatan1</th>
                                <th scope="col">Disposisi1</th>
                                <th scope="col">Catatan2</th>
                                <th scope="col">Disposisi2</th>
                                {% endif %}
                                <th scope="col">Catatan</th>
                                <th scope="col">Disposisi</th>
                                <th scope="col">Tujuan</th>
                                <th scope="col">Action</th>
                                <th scope="col">Lihat Surat</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for surat in surats %}

                            
                            <form action="/disposisi/" method="post">
                              {% csrf_token %}

                              <tr>
                                  <td>{{ forloop.counter }}</td>
                                  <!-- halaman disposisi untuk admin rektor -->
                                  {% if grup.name == "rektor" %}
                                  <td>
                                    {{ surat.nomor_surat }}
                                    <label for="{{ form.surat_id.id_for_label }}" hidden>Nomor Surat</label>
                                    <input type="hidden" name="surat_id" value="{{ surat.id }}" id="{{ form.surat_id.id_for_label }}">
                                  </td>
                                  <td>
                                    {{ surat.perihal }}
                                  </td>
                                  <!-- halaman disposisi untuk admin wr -->
                                  {% elif grup.name == "wr" %}
                                  <td>
                                    {{ surat.surat_id.nomor_surat }}
                                    <label for="{{ form.surat_id.id_for_label }}" hidden>Nomor Surat</label>
                                    <input type="hidden" name="surat_id" value="{{ surat.id }}" id="{{ form.surat_id.id_for_label }}">
                                  </td>
                                  <td>
                                    {{ surat.surat_id.perihal }}
                                  </td>
                                  <td>
                                    {{ surat.catatan }}
                                  </td>
                                  <td>
                                    {{ surat.keterangan_id }}
                                  </td>
                                  <!-- halaman disposisi untuk admin dekan -->
                                  {% else %}
                                  <td>
                                    {{ surat.surat_id.surat_id.nomor_surat }}
                                    <label for="{{ form.surat_id.id_for_label }}" hidden>Nomor Surat</label>
                                    <input type="hidden" name="surat_id" value="{{ surat.id }}" id="{{ form.surat_id.id_for_label }}">
                                  </td>
                                  <td>
                                    {{ surat.surat_id.surat_id.perihal }}
                                  </td>
                                  <td>
                                    {{ surat.surat_id.catatan }}
                                  </td>
                                  <td>
                                    {{ surat.surat_id.keterangan_id }}
                                  </td>
                                  <td>
                                    {{ surat.catatan }}
                                  </td>
                                  <td>
                                    {{ surat.keterangan_id }}
                                  </td>
                                  {% endif %}
                                  <td>
                                    <label for="{{ form.catatan.id_for_label }}" hidden>Catatan</label>
                                    {{ form.catatan }}
                                  </td>
                                  <td>
                                    <label for="{{ form.keterangan_id.id_for_label }}" hidden>Keterangan</label>
                                    {{ form.keterangan_id }}
                                  </td>
                                  <td>
                                    <label for="{{ form.tujuan.id_for_label }}" hidden>Tujuan</label>
                                    {{ form.tujuan}}
                                  </td>
                                  <td><button class="btn btn-secondary">Submit</button></td> 
                            </form>
                              {% if grup.name == "rektor" %}
                              <td><a href="../../media/{{ surat.file_surat }}" target="blank"><button class="btn btn-secondary">Lihat</button></a></td>
                              {% elif grup.name == "wr" %}
                              <td><a href="../../media/{{ surat.surat_id.file_surat }}" target="blank"><button class="btn btn-secondary">Lihat</button></a></td>
                              {% else %}
                              <td><a href="../../media/{{ surat.surat_id.surat_id.file_surat }}" target="blank"><button class="btn btn-secondary">Lihat</button></a></td>
                              {% endif %}
                            </tr>

                            {% endfor %}
                        </tbody>
                </table>
        </div>
      </div>
    </div>
  </div>
  <!-- partial -->
{% endblock %}